#!/usr/bin/env python 
import string
import collections
import sets

# XORs two string
def strxor(a, b):
    return "".join([chr(ord(x) ^ ord(y)) for (x, y) in zip(a, b)])

c1 = "bee47895cc7238ee2f9012595c972482ec80fa6ac4a742f5a7940ff0190be6b3827fa337c4797773f6371ec773445a424a7c4cfb09c89d69adabf43f10b8f737fd120a3e07e6c922925199a814784ae0ec3120343e3124c70b0f04b3f6f3743d244d9010bf2bfb69196121b4b88793fbda8bd4dfd0b408f0fe018a4c3c4e92ebb2a35e055c7358ad97595331e10822c9335b463e1fe7b2b7aef059f9a21b6048b43b0abf820f4cc88075fc6162dd83e1c6"
c2 = "a4ea7fc6d4727d85248c0659529f7186e088a33c85a549e2b4944eba1f02f7f88979e737dc34336cb52805da79167457517207ed47cdcf64e8ace53f16babe3cbc59173815e79320c8538fb61a2006c2e9242a242d6507f52f016799e5ee7b392458d10ebf0ae17e56692fa1b98d96fbc4839191dbac49a2e111845b204e929891bd5e155b7654fe8a4f1722e11e31d57f071c3d09f0f2fec4ee42e5b9496d4aab6c0dbad70750c69030b4636adf95e98d34a8a023f76c793089385ca4830fbfda9cf760d6bcd3bba2047dca4d7e4da37fde9ca4dc941a90daea8490f2606c414b8fa40981a6918cbc666d917cc1a24dbd66612f14498a40d600c55446da93d7f3f4b60aa5aaaccf92919274b650fdc97c7b292c90f48c5fe087b3763fe4416ed36657870b2d6098707ded58e07bcdfe1ac7d47e32642104a44df41b93700a4f64bde8d0ddb06bddf39beaf608841aebb93e85df0abf184ccfd89b150922364270148240e027940ed98d3f991a00e449c0b7fcfc2b4a72ea5764ed30714fa6eda5cde36823dc13e388b97350367fb5760b2ac2d16c6f6c9328555640c03de27370176dc60d3157a310a2fb3e468aecf0b9579e978f13367e1e3e00f5e4c7d7f4091b6bf98e6a9ee07b6d3cb69f97db3a6f978a2336b6bb05821a409b47f19bc5523322572498fcf864a08d9414ac9782edf3fa34d8aaa5d41a42bb7852e8540425b74a5967d2ab"
c3 = "baea64d49f7734aa2e8d0e511d9f349fe08efa7cc48245f4aa870fed051fe0f28563eb79d0713a70f62b5ff170534845446508fe4cd5cf58bfbee6231ea8a02af75b097112e68d20c85a83b95b785fe5f0317320776101f23a44478be1f73a1a364b860efa0be77e17333da6a59f9bb8dd8bd4dad0ad1eb5e01081467917cba98abd5c0c57701dd78d53532fe71839ca7d0b017236f6abb7ede216fabf086d4ce0791dbd820252c78663a66969d983aca426afa32eec6f345ed96f59a89f0fbbd4c9f7649da09ab0ed324bfa09684da274c29ea6dc971bc7d1e08ed5a7304c0d548fbf0f94a09880b76165d42cc9b14da760252c144b9c4e9501cd4b0ff48ed6b5ffa50baea3b5c59cf4"
c4 = "bee47895cc7238ee2f9012595c972482ec80fa6ac4bc4fa7b1824ee91211f7b3847fa03cd370367bb8285fc06e4c5a414a6f0fed09eb807fa1bbf43f19a2a43af5125b7107f1883bc84eca9d17694dfafa303725327c48d83940579fedf96d273c489c47a040fa651b7c39aaa7ccb8a9d8849dc2d3a21eb1ae3884423612ddbc96a4561355751de386164324a80b31c4700b45722ae1bdbdefbb46e5ac106b46ad7505f282095ac99b6ab92c77dc87f88826fda86ff473676ad5625deb830fbbd59ae76a85ac9aaced2741e4502453bf7adf9bba969a5ecad9a39492e272640411c6a51387e9cb8aa87660d82cc7b943ea63642a5d5dd071d409c35813b1c399f8feb306eba7a7cb92838371a048f3953d642863b2e2c05fea83b37d38e7546eed775b8c0f7e639d272bed73e06b86bd22cfdc391f386e20ac55b80d9d3e284b68f2e09fc4a273ceaa9afbba5a9c40ebb924c0cb49be1409c7d8840f0a2235423d14944cf83f950b90c33b9d0502ac5ad6b0f1a56e1857ec4a6aae346559f5ffa9c2e423329316e48dac6f443a60f46a5565dfc62d607a8871115341df37fa64611c6b950c3d47bf10b1ba20468cf4acfc4085cece1e34660e3845b0a9d5d4f04a1172f4dc6599ec3c2d75"
c5 = "a3e972c6d17238ee3b90014054803084a9d8ae2a81bc4eeee68540f4080af3f89c3aa9389d762e6abf345fdd795b465b054816ed5ad9827ae8abe73712afb679ec401e3417f18822c41490b9197506f9f42a363a776511ff2b015388e3ee7b377901b315f00efd771a7239e3808397b4c58583c2d4aa49a0e1179b462a01deebd0e25313467454ad8c595935fa1a28d133000a7218eabfb7ebbb5bf2bb0c6c03ff3b14b1cb0353c49b7db37b66dcc6c58834a9b83beb623452c47756a2870abfc988bd4e99a2d5aced325dfb406143a93f90"
c6 = "bbe669ccc8722ead229a45535280719ce880a3368bac45edb4944aed1d14f7fec43aa5369d637759b93d10de755f0346446505ac64d98374a7adef2c03acf72ee555083014e28520c84098b3186443a9f23032342d7402bf6e404894a4e876213a40921de60cf169566021a1a289d6fbcd8fd4cbd2aa0cbee71f8a0f2a09d7eb95a01f014b6a5ce98c431736a8590e85790f007217fab0b1fdf814b7e949654ca47a0ebb820415d18862a6696cd1c6ff8f22f1e135fb367a71967259a09d15fedd93fc76d6a2cfadeb6541f4596b47bc70d3d5a098db0ad5d9f7858ea9304e0946c6a71299aacb84bd656d9161dab447b96a2525120a8444df45d15803ff8599f9f4a303aae9b186d9b59069aa55f3da752f632cadf49745abd1b3567de44120e9327d88163f7e837e72a47aa155c9f315d4d87c7d30782dbf43f41c85690c407ff8fc99d2fd38c6e69da2bc0f9140e4b333c08547b9184c9399a71916227b473550855bf82dc112d5da3b9b095be467cab7f3b5604f64ee5f64e32c3a00ebeea1d5b07962bd13ef80b07c473165f06b590ed2c27e6c6a817f42485ad76de16560133fdb0f3d14bf49a7b025038fadf0b5439e8b8f133d6c5d"
c7 = "b5a563dac57a7dba32924552589d348ee08ee9238abc4be6e6844ae90858e1e98b60a22ad17d2068f66e5fdd73414a16507916e94dd68670b2b4f46d1eeda72be65717281ce2c92f8959caa61f6643eaf23b7310326201f23c4a4dd1eafd3a3e324bdd47ed1af16f197e21efeb9e95b7dec4d4f09fb402a2e107884a7902d7af9fa65a56587f4ef7844c5261fb0120df761d073b0de0a6bfa0bb7cf6bd49724aa53b00b1d50454cf9c7ab9617e9cc6e38435bcbb6ff473676496725daf9a1fb39e93bd6397b8d5acfb3141e7097304b663ca90bb9d8919c598ed96dbe97f7a0411ccb1189db1849dbe667bde7fd0b108865d406f5d"
c8 = "baea64d49f7634a13f9304104ad3359afc97fa288dad00e8a2ce5dfb060db2e49273a235dc342460b3711bdf3c444c544a7f15a209eb9b72a6b6e62116baf71ae65716320ae69a2e9f1484bd5b7c4fece929202d2e7c48e73c444a98eafb6f7438459615e61af824187c29a6eb969bacd88e9ad8d4ac1eb9a253910f3214ddb980a8505642754ef986414e61e61226857117077200f2b8b1f9f45af8b810211ce07f0bb0cd1e5c8b827ca96e68c787ac9222b1a438f76c7e71983876a4831ffeca9bf86b93bd9a92e72247f9095345b462ca94b89ddb04d1c8ec8092e6746c0d11d8eb0a97b28288b66e6fd92093a24dea676c245d489545cf0cc71b12fe90dce7feb30ea7e9a2dfc1bf976eaf52b2d03d682b65a1e18443f994f67934f50034e532459d10316280276ca473ea7edae70882917229257337a64ef44e8d720c536be4ffd0c9b07cc6e491e7bb5a8105f5a269c2d74bb453079d99"
c9 = "aee47edcda6827af259600104a9c3a87e5cdf4368dbb55a78d9c56e90801fceac850a637d96d7b29a17114c473445a5b057b03ff42d99d69b1b3f46d04a4b275bc4801711eea8c619a5b90ac147648e8f77e39323d311be33c5b4195e5eb79357756d114f40cf1741f7662e3be889fa9cd9398de9fb110bbe100914a2d05dfeb92ef5b0c5b7b51ec8b585832eb5b22d76717182603f0a6b0efbb42f2bc49765aa27210b0c70715ca8264b37e6cd9c8aca53da8ab2abe657d7596774bb1810dbfd090bd6f97a4d5fef1314ffc502446bf66d199aa9fdb2ad5d9f7858ea740620d5ec1a21ccefacb84bd78659162d2b508a87069385d40855b9503c35546e599d3b5e6a51db8b3a7d1c1bf8b78af1be1da78612522e0a4c06ef282f67a7de45234e5795987033075d52766a83ff57088e914cfc56b7d076022a249a6168b6a1a044ef2e885d0b977d0f993ebb310c740f1f622d1ca58ae1c09d0d683174136375e3e5d8f47f26c8015c4c220931141a35fcee4f8b02f4f73ec0d77e139730ea6c1adc7b07735951af88fb974093b76e67c5937cad9606d7487691d035dd326f72073524fda0a375aa259ebb52346d8fdf2b34085998d05787004265ebafec7d9ef030128f6c13089a97c6f30b3899994"
c10 = "cba531f2da6834af399404121da13e85e883e266afa743efa78040ed0f13fbf68f75e733d8672329b03e0ddd7d5a4d5f402b06e94dd6967ee8a5b52316a7a030f959172b09e081618a5184b91d6545e3fe30273820310ee620455182fee53a2139489b09e603fc2418726e93a48891bac59a95d2d6b647f0ae389f402a40c5eb8faa55565b7754e8895f4261ec1430d172024b3c13f6b8bff9f559b7e459214eac7544bbd71f5a8b8d7fa86d64da8fac9329b4ab21e7757c3089385ca4830fbfda9cf760d6bcd3bba2047dca4d7e4da37fde9ca4d2db34d1d3a38082e979660011d5eb1981ae9e84b76178d06fd9b108bd2944261844934bdc45ef5402f48ed7fceba50ca1a0e6cf9286876eb149e7d2697a2e75bafa8346e2cec17831fa492df46557c5427c4b9c7475ac6dea7e8abd1bcbc26d7d3d6d2fb645bd0f837b0f4168bdf687c6b562ceef8bf6a35a8c0ff5a626c1c458a4055e9dd0c90508263f463541c04ff63e8c5ed4df3d9a1914e80dd8e4eba52d1872ea577cf93c6543efeeecc5b064278f16a4cb"
c11 = "a3e077d9ca7c7da02a8c1f495e9b7181e78bec3489a943edafce6ef61913e1f2867ea22b9d5f2068a53f16d56b45485f056119f609cfcf67adb1b53a12a8bc3cf256442b11f3863b87438bb05b6849a9f0373f3c227512fa2b524d94e7f56f743a449c08e84cb46f027c3ca6eb9c95b1d69d9dd09fb000b5ae1d8a0f3b09dea787a05e04567b5ee5c75f5320eb1e298563014b2516f2b8a4ebbb6cfdb30d6f4ca3610bb0c70715e78c67b56f7e9ec6c9962eaeaa20ee776030c47d59ac810cbb9e87fc2595a0d7b7ec220eff5c7004ad629ed58c949a0cd1d5f08ed5a73047144b8fbc5d9aa0cb87bb6a68cb65d6b44dea6b6c32165f8048951fce520de695dde0fba54fa3a6abc9c1b1896eb05afed067627c"
c12 = "baec76d8d67e3ea522df0e5f5390349ae7cdf9288bbf00e9a7ce4ce01314fde4837ba4319d672060b72510c765554b16486e08e546cfc13386bee22803edb436bc46162b15e08061895f9ea50c625fa9ec2b3f3c367f48fd2f017e98e1f17374274e920ff004ee6d567c2ae39d8396b0c49d95d6daad08f0b1538448350fc1a289a61f18536f56e290554e61f25b14dc7714023316e6fc90efee5db7b9495b4aa5760dfef7035cdc8c62af7573d592f9c610b4a42bfb78677bdf7d5fa4da4699db86f16a92b5c3f2a22e5aff5b7e5de675df9ea0929a12d998f39896ee717f1411caa6149daf82c9a82f7cde62d2bc08b96c712a140a9e40df12cb5e0de286c0f6f9e418bea5adc7dcbb9531e541e5cb726c3560a9bb955bea89f63b7dee456eee7b538216317e9c2766ed71e87cc0bd0bc3df7038207234a44aad4c99750f4561bde18ad8be7ccbe38ffbb512cb10ffba26d28544b6514ac7d89a5603223f4a325d8105b336841cc98d22975016bd47cabefba6295d3de74c70e53a6143e9fcecdbe26c21951caa8fac3d5e3c72fe750320cf836c69779d7f5f4c40d924ad20"
c13 = "bfea7dc1ca6137a13c9e0b491d89309fe689ed2f8fe85ae8b59a4ef65c0fe0f2923abd3c9d672066bc305fde735142164a6f09ff45d9816ae8bbfa6d05a8ad3cee454a7150d48c2584418dfc0c7f52eceb302a343f3101fd284e569ce5ff703d77439403e509f12406723bb9a49b9bb897899b91d1a203bde01a8e457910c0b180b51f02406044ad8a5f5232e11a20c03d4e2f201bfebdaaaef94fe0b7056242e06f01bfd61f408ba262a57f73c988f5c60dbcaf2be7383430"
c14 = "b7ed64dcd3742aa16b920a5a5cd33c81e582f025c4ac4fa7b28b45ba0f1bf7fd913aab3cda783629a17114d16e424c58446804ac1698827cbfb6b572578cf729fd5c0d713be29d209a4e93b2126906c3fa30372d3e7448e937425e94a4ec752338458b02f109f528567222a6eb868fa1978891cbdae304bee716c50f170fc5aac5a35612576856ecc75a5236e1183a9f33240e2116fafca9f7fc44f6bb102d03ad7e09a7821715ea8575b77f66de82fe832afd8a38ff657a79d36f4ba09d0bfedc8cf964d6a1d3bba23157fc426b04b131c09cae889e1dcadde8d7b5e67a7a0854c4b8078fe5988cbc7c6dd266d2f843a567722413499a489512db5909e39fc3f0fbe435a1aca2c8ddb79872ab5ef899516a2b65a3e2c041e28fff787df6592da07d51850d2d769c6975a83fc37edaff10dcc8391325762fa64dbd09803e09456ef2b29edca67dcdaa94ebb21f990beff625c0d243b408079d99"
c15 = "b0f772d8de6f7dac3288045c5e92719cec8cf73491e86bf5bf9d5be31201b2d98974a3209334775eba300cde755303454c6e4ce846cf8676aca5fc2c1be1f723f9122e301ee788619c5bcab2126906c4fa323438256b09e72f016f9efee9793c3856820cfe40ce651b7a2bb0b18d94b2d2ca83ded4ac05f0f903825c2c40f9b99cbc4b0f5c631dc786585338a45b3485781a042003fefcaee1e85df6a413784fa13b17b7c74115d18c30b265629094e39c37b2bb21ff7a347ad37218b88414a4db8dfc7295ae9aa9a23645fc4c744da33d9080ab998904c9d4ecd789fe7b62124bcabf1883e59cc9b67565d060d2b446a57a66611c588458c611db581cff9d99e1f4ae4fbcb0a4cfc6ba8777e55af9cd727d3765eebb"
c16 = "cba551d4cd7f27a16b8c0c551d89719cec8aec6687a145f4bc8b0fa55c13fdfe8d74b32cd771777ef62310ca7159545f402b16ac68ebb577b2b6f02319a4bc30f95f443911f39924865198f25b2c19a9d13b2023327c48e33c5b419aebf27b3a2e0dd11dfa40f96b1c3326a2bb9c9fb5de849391cfac13a7e11f820f3d0fc6b99faa5c5656751dfe82525920a80f26c27c4e182215ffb9bdf4f55ff2f6026e4db4690ba9c71f46d2837eb96b689095f88729a8e120f5647163da7956ae9309fed488f66ad6edd8bff02154ff09664ba170c48cedd2db34d1d3a39a94f079214141dda4178bae9fc9b86a7fc52cc3b74cb060602d12448901db0482500ffd97d8b5f7a515e7e9add2dda6873de81be6d63d782561affcc048e49af27437fd0063a070538d037e7f927566a86bef76cdbd15c1da6c302f6f3aaa51b5028f3e0d4525fffe9fd4a43687aa"
c17 = "a4f772d6de3b2dbc31860f55509d30c4a989ec2496b245a7b6824eee1219b2fac870a22ac7772d6cf62616d57745595956684cfe46da8067b1ffe2341ca2b92cf653442b11a38a288d5683b95b6548e7f27273342d6804fa6e55459aa4f67b3f7756d137fe0cf567033371e3a6838db2978495dc9f9408bceb008a03790bc6a497b61f0553771de782454361e51e2ec07e4e04365aa4fcb2efef18b785086c0382690bb0cb1e59ca9e3097636adf94e39134b6a86ffc6f7830c13855a49903b0dd80f8258caed7a7e92440f9482450a37ac381badc9517d5cde09f8cfe6463181f8f811889aacb88a1767fc569ddac08ba666c2f1b45824cda12c3574ab186dcb5f3bd03b2e9b6d4d7ae9b79a055e699776a2f78e0e18146ee9aea3b7df64f6ea2655a881130659c276fa47aa16cd2f803dbdb7c7f642103ac47b803ca7c1a4725f2e184c1be3487eb94e7f6148205a6b73385d14bbc5f09efd69a0f0b3030427c40924cfd29935efcc835911941ab49c8b6e6a62c1873e64a60ae2f7757e9efa2c5fb6c35955fe48ae3695b3079fc681e3085"
c18 = "bee060d9d63b27aa249d0054479a3485f0cdf42a85ac5ae2eace42ff1101b2e9c85bab3cd6673667b2231add3c7d5457566505e95ecb847aa5fff72813acf72af55744211fe98836815589fc156543a9ef273f3c38311fb33e484585e1ff60313c01ce47f01afa651c7e27afaacc8da2c08598c4d5a20af0ea0982443040d7a591ba451c536050ad89571732e9172a8b33240a395af2aeb9fbf653f9a2067642ac7a48fecb0341ce9b7eb97868c783ac8b22b0b86fe4367875c1715ba4831fb39e99ef608cb6debbec314bfd097304b47edc9cef9b9711c7d6e69ddbf37f2d0e53c0a05d99bc919aa8766fd92cc3b449a929663b040a9440c708cd4c1ff29499effdab0da0a6b186d9b8977ebf54e5c03d6a3069adfe8e58ab99e17627f84939ef615580423a76907475a875f265d1fe198ec56b27336534ac43a718857202506ef2e5de938177d0e39deff60d8205e5b3239f854db3084bc499871f04632f4e7c5b825bf2368a179c8d3c911541a654c3abfda5605573e04825fa20365aa6fcadc1f9237ddc08f391ad7c453437f1691d24cfc26e22709e6b4b4641c028af207e173fc1097843a751b8b52346d8f7e1ae56858c80002f625d3d43b8ecc8c9f418186db18c519fec757034b998c5d5684d85852439bcb417d1024c9553ebd8894c20785c2ed7e6f863b881de1ef4d88ae9f3af7eee9595d41c5ca8674cfb50040dbd5e562686ee9b2f9bc921cbf7b6bc213807d20d0dde277c"
c19 = "baec7695c57a2da126960b51579e28c4a997e66690ad4ea7b58f42ba0f08fde08778e723d17d3c7ebf3510c77d5a4a4548724cfc46c89d69adbbfb2418edbe37bc440d2502ecc5619b5181af5b7c54f3fe3a3e363b6b0dfd3d4a4dd1edbc7330324e9d08f809f124117620a7ae9ed4fbe48f9ac2dea010bae016cb403d0bc0b286a65a56557f52e188515836a65b638750014b2608e9b9bde7bb57fca210764db93b13abce0654c5c97ebd2c74c78fe9852eb8e13ff1757c7fd26251eb9b02fee886f16e85b8dbb9e72b4fb209"
c20 = "aef26ad6d67e2ea5229a0f1049923a9cf086ea6697a145a7a8874aba0615fbf68673a67982342365a33c1ed3664f03544c7807f95996cf5da1bab53716bdb834f55c053b1dfac5619251caa81e6206fafa337324277e1bfc2c015e9dedf76d3d334e8606f309e7690f333eacbb9e80bed3849dde9faa07f0f81a9f5d364c92b880a44c56426847e8835b562df21e2dd678074b3b5afab8bbe1f759f0bf0c2144a57500bbd04315f88c7eaf6d64c98ce28367b2a524ec6f7779d3385fae9b0ab1d986ea2bd6ef"

#target_cipher = "bfec7dd2de3b0fbb38960b104f9c3381a99ee62a82a145a7bcce58f31914f0ff897ea234933a79"
target_cipher = c1;
ciphers = [c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20]

final_key = [None]*600

known_key_positions = set()


for current_index, ciphertext in enumerate(ciphers):

	counter = collections.Counter()
	
	for index, ciphertext2 in enumerate(ciphers):
		if current_index != index: 
			for indexOfChar, char in enumerate(strxor(ciphertext.decode('hex'), ciphertext2.decode('hex'))): # xor the two ciphertexts
				
				if char in string.printable and char.isalpha(): counter[indexOfChar] += 1 # Increment the counter at this index
	knownSpaceIndexes = []

	
	for ind, val in counter.items():
		if val >= 12: knownSpaceIndexes.append(ind)

	xor_with_spaces = strxor(ciphertext.decode('hex'),' '*600)

	for index in knownSpaceIndexes:
		final_key[index] = xor_with_spaces[index].encode('hex')
		known_key_positions.add(index)

final_key_hex = ''.join([val if val is not None else '00' for val in final_key])

output = strxor(target_cipher.decode('hex'),final_key_hex.decode('hex'))
print ''.join([char if index in known_key_positions else '*' for index, char in enumerate(output)])

#Manual step
target_plaintext = "Jak sie dowiadujemy, obraz jest jednym z faworytow w przetargu na nowe czestotliwosci LTE. Bronislaw Komorowski ma nowa prace. Wlasnie podpisal 5-letni kontrakt na bycie memem"

#print target_plaintext
key = strxor(target_cipher.decode('hex'),target_plaintext)

for cipher in ciphers:
	print strxor(cipher.decode('hex'),key)
